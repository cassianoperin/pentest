#!/bin/bash

EXCEPTIONS="var SETTINGS|--|>|<|favicon|jpg|png"
TMP="/tmp"
TMP_FILE="$TMP/$1.tmp"
TMP_FILE2="$TMP/list.tmp"

# Argument control
if [ "$#" -ne 1 ] ; then
   echo "$0 URL"
   exit 1
fi

# Download main page
wget --no-check-certificate -q $1 -O $TMP_FILE

# Filter HREF entries
grep -ai 'href="' $TMP_FILE |sed 's/href=/\n&/gi' |grep -i 'href=' | cut -d "/" -f3 |grep "\." |sort -u | cut -d "\"" -f1 |grep -Ev "$EXCEPTIONS"  > $TMP_FILE2

# DNS Lookup
for site in $(cat $TMP_FILE2) ; do host -4 $site |grep 'has address' ; done |sed 's/has address/=/' 

# Clean Temporary Files
rm -f $TMP_FILE
rm -f $TMP_FILE2

