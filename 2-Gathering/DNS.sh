#!/bin/bash

# Gather information based on DNS

domain=$1
list="DNS_sub_list.txt"

# Argument control
if [ "$#" -ne 1 ] ; then
   echo "$0 DOMAIN"
   exit 1
fi

echo "####################################################"
echo -e "1 - Looking for Name Servers\n"
NS=$(host -t ns $domain |cut -d" " -f4)
echo -e "$NS\n"

echo "####################################################"
echo -e "2 - Looking for Mail Servers\n"
MX=$(host -t mx $domain |cut -d" " -f7)
echo -e "$MX\n"

echo "####################################################"
echo -e "3 - Trying to Transfer Zone\n"
for nameserver in $NS ; do
	echo "Trying to transfer zone from server $nameserver:"
	host -l $domain $nameserver
	echo -e "\n"
done

echo "####################################################"
echo -e "4 - Looking for SUBDOMAINS and DNS Entries\n"
for i in $(cat DNS_sub_list.txt) ; do
	host -t A $i.$domain |grep "has address"
done

echo -e "\n"


